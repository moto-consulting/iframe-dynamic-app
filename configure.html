<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Configure iFrame</title>
    <script src="https://res.cdn.office.net/teams-js/2.17.0/js/MicrosoftTeams.min.js"></script>
  </head>
  <body style="font-family:sans-serif; padding:20px;">
    <h3>iFrame konfigurieren</h3>
    <label for="urlInput">Webseite-URL:</label><br>
    <input id="urlInput" type="url" placeholder="https://ruwacbi.de.qlikcloud.com/dashboard" style="width:100%;padding:8px;margin-top:6px;"><br><br>
    <button id="saveBtn" style="padding:10px 16px;">Speichern</button>

    <script>
      microsoftTeams.app.initialize();

      const saveButton = document.getElementById("saveBtn");
      const urlInput = document.getElementById("urlInput");

      saveButton.onclick = async () => {
        const url = urlInput.value.trim();
        if (!url) {
          alert("Bitte gib eine g√ºltige URL ein.");
          return;
        }

        await microsoftTeams.pages.config.setConfig({
          entityId: url,
          contentUrl: `https://ruwacbi.de.qlikcloud.com/content.html?url=${encodeURIComponent(url)}`,
          websiteUrl: url,
          suggestedDisplayName: "iFrame",
          removeUrl: "https://ruwacbi.de.qlikcloud.com/configure.html"
        });

        await microsoftTeams.pages.config.notifySuccess();
      };
    </script>
  </body>
</html>
